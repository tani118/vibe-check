<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Album Cover Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #1a1a1a;
            color: white;
        }
        .test-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .test-item {
            border: 1px solid #333;
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            background: #2a2a2a;
        }
        .test-image {
            width: 150px;
            height: 150px;
            border-radius: 8px;
            margin: 0 auto 10px;
            display: block;
            object-fit: cover;
        }
        .fallback-image {
            width: 150px;
            height: 150px;
            border-radius: 8px;
            margin: 0 auto 10px;
            display: block;
        }
        .status {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            margin-top: 10px;
        }
        .success { background: #4ade80; color: black; }
        .error { background: #ef4444; }
        .fallback { background: #f59e0b; color: black; }
    </style>
</head>
<body>
    <h1>ðŸŽµ Album Cover Loading Test</h1>
    <p>Testing Spotify album cover URLs and fallback system...</p>
    
    <div class="test-container" id="testContainer">
        <!-- Test items will be generated here -->
    </div>

    <script>
        // Test data with various URL scenarios
        const testData = [
            {
                name: 'Happy Hits! (Working URL)',
                image: 'https://mosaic.scdn.co/300/ab67616d0000b273072c0dc66c1c00d1fbbcc48aab67616d0000b2737ea4cd62166ea08eb8a9ab67616d0000b273c8b444df094279e70d0ed856ab67616d0000b273ef0b4e66ef2baf36ac03d0',
                vibe: 'Absolutely Radiant'
            },
            {
                name: 'Mood Booster (May Fail)',
                image: 'https://i.scdn.co/image/ab67706f00000003e8c4b8b0456e09b0dc4b8333',
                vibe: 'Super Positive'
            },
            {
                name: 'Intentionally Broken URL',
                image: 'https://broken-url-that-will-fail.com/image.jpg',
                vibe: 'Pretty Good'
            },
            {
                name: 'Another Working Mosaic',
                image: 'https://mosaic.scdn.co/300/ab67616d0000b273031ff5c5b20cb2e088e42bb7ab67616d0000b2734e0362c225863f6dc2c19ab67616d0000b273508c8ab28ae76cfdc5e0b84fab67616d0000b273e559b39ad9a8ecbfa86e0',
                vibe: 'Decent'
            }
        ];

        // Fallback image generator (simplified version)
        function generateFallbackImage(playlistName, vibeName) {
            const canvas = document.createElement('canvas');
            canvas.width = 300;
            canvas.height = 300;
            const ctx = canvas.getContext('2d');

            // Define vibe-specific colors
            const vibeColors = {
                'Absolutely Radiant': ['#FFD700', '#FF6B6B', '#4ECDC4'],
                'Super Positive': ['#FFA500', '#FF69B4', '#00CED1'],
                'Pretty Good': ['#32CD32', '#1E90FF', '#9370DB'],
                'Decent': ['#87CEEB', '#DDA0DD', '#F0E68C'],
                'Neutral': ['#D3D3D3', '#B0C4DE', '#DCDCDC']
            };

            const colors = vibeColors[vibeName] || ['#8B5CF6', '#EC4899', '#06B6D4'];
            
            // Create gradient background
            const gradient = ctx.createLinearGradient(0, 0, 300, 300);
            gradient.addColorStop(0, colors[0]);
            gradient.addColorStop(0.5, colors[1]);
            gradient.addColorStop(1, colors[2]);
            
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, 300, 300);
            
            // Add music note emoji
            ctx.font = '60px Arial';
            ctx.textAlign = 'center';
            ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
            ctx.fillText('ðŸŽµ', 150, 130);
            
            // Add "PLAYLIST" text
            ctx.font = 'bold 16px Arial';
            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
            ctx.fillText('PLAYLIST', 150, 180);
            
            // Add playlist name (truncated if too long)
            const truncatedName = playlistName.length > 20 ? 
                playlistName.substring(0, 17) + '...' : playlistName;
            ctx.font = 'bold 12px Arial';
            ctx.fillText(truncatedName.toUpperCase(), 150, 200);
            
            return canvas.toDataURL();
        }

        // Create test items
        function createTestItems() {
            const container = document.getElementById('testContainer');
            
            testData.forEach((item, index) => {
                const testItem = document.createElement('div');
                testItem.className = 'test-item';
                testItem.innerHTML = `
                    <h3>${item.name}</h3>
                    <p><strong>Vibe:</strong> ${item.vibe}</p>
                    <img id="img-${index}" class="test-image" alt="${item.name}">
                    <div id="status-${index}" class="status">Loading...</div>
                `;
                container.appendChild(testItem);

                const img = document.getElementById(`img-${index}`);
                const status = document.getElementById(`status-${index}`);
                
                // Test image loading
                img.onload = () => {
                    status.textContent = 'Original image loaded successfully';
                    status.className = 'status success';
                };
                
                img.onerror = () => {
                    status.textContent = 'Original failed, showing fallback';
                    status.className = 'status fallback';
                    
                    // Generate and show fallback
                    const fallbackSrc = generateFallbackImage(item.name, item.vibe);
                    img.src = fallbackSrc;
                    
                    // Update status after fallback loads
                    img.onload = () => {
                        status.textContent = 'Fallback image generated successfully';
                    };
                };
                
                // Start loading
                img.src = item.image;
            });
        }

        // Run tests when page loads
        window.addEventListener('load', createTestItems);
    </script>
</body>
</html>
